 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>User Profile - Add & Rate Movie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

  <style>
    body {
      background-color: #1e1e2f;
      color: #fff;
      font-family: 'Poppins', sans-serif;
      padding: 2rem;
    }

    .nav-tabs .nav-link.active {
      background-color: #4ef037;
      color: #000;
    }

    .form-label {
      font-weight: bold;
    }

    .table-dark th {
      background-color: #333 !important;
      color: #fff !important;
    }

    .btn-primary {
      background-color: #4ef037;
      color: #000;
      border: none;
      font-weight: bold;
    }

    .rating-stars i {
      font-size: 1.5rem;
      color: #ccc;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .rating-stars i.active {
      color: gold;
    }

    .rating-count {
      font-size: 0.9rem;
      color: #bbb;
      margin-top: 5px;
    }

    .movie-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-top: 1rem;
    }
  </style>
</head>
<body>

  <h2 class="text-center text-success mb-4">ðŸŽ¬ Add & Rate Movies</h2>

  <section id="movies" class="content-section">
    <ul class="nav nav-tabs mb-3">
      <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#addMovie">Add Movie</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#viewMovie">View Movies</a></li>
    </ul>

    <div class="tab-content pt-3">
      <!-- Add Movie -->
      <div class="tab-pane fade show active" id="addMovie">
        <form action="/addMovie" method="POST" enctype="multipart/form-data" class="row g-3 needs-validation" novalidate>
          <div class="col-md-6">
            <label class="form-label">Title *</label>
            <input type="text" name="title" class="form-control" required />
            <label class="form-label mt-2">Description *</label>
            <textarea name="description" class="form-control" rows="4" required></textarea>
            <label class="form-label mt-2">Release Date *</label>
            <input type="date" name="releaseDate" class="form-control" required>
            <label class="form-label mt-2">Genre *</label>
            <select name="genre" class="form-select" required>
              <option selected disabled>Choose genre</option>
              <option>Action</option>
              <option>Comedy</option>
              <option>Drama</option>
              <option>Horror</option>
              <option>Romance</option>
            </select>
            <label class="form-label mt-2">Director *</label>
            <input type="text" name="director" class="form-control" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Language *</label>
            <input type="text" name="language" class="form-control" required>
            <label class="form-label mt-2">Country *</label>
            <input type="text" name="country" class="form-control" required>
            <label class="form-label mt-2">Budget *</label>
            <input type="number" name="budget" class="form-control" required>
            <label class="form-label mt-2">Revenue *</label>
            <input type="number" name="revenue" class="form-control" required>
            <label class="form-label mt-2">Runtime (minutes) *</label>
            <input type="number" name="runtime" class="form-control" required>
            <label class="form-label mt-2">Poster *</label>
            <input type="file" name="poster" class="form-control" accept="image/*" required>
            <label class="form-label mt-2">Trailer URL *</label>
            <input type="url" name="trailer" class="form-control" required>
          </div>

          <div class="col-12 text-end mt-3">
            <button type="submit" class="btn btn-primary">Submit Movie</button>
          </div>
        </form>
      </div>

      <!-- View Movie -->
      <div class="tab-pane fade" id="viewMovie">
        <table class="table table-bordered text-white">
          <thead class="table-dark">
            <tr>
              <th>Title</th>
              <th>Genre</th>
              <th>Director</th>
              <th>Rate</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Sample Movie</td>
              <td>Action</td>
              <td>Christopher Nolan</td>
              <td>
                <div class="rating-stars" data-movie="sampleMovie">
                  <i class="bi bi-star" data-rating="1"></i>
                  <i class="bi bi-star" data-rating="2"></i>
                  <i class="bi bi-star" data-rating="3"></i>
                  <i class="bi bi-star" data-rating="4"></i>
                  <i class="bi bi-star" data-rating="5"></i>
                </div>
                <div class="rating-count" id="count-sampleMovie">Rated by 0 users</div>
              </td>
              <td>
                <button class="btn btn-warning btn-sm">Edit</button>
                <button class="btn btn-danger btn-sm" onclick="confirmDelete()">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- JS Section -->
  <script>
    // Star rating script
    const ratings = {};

    document.querySelectorAll('.rating-stars').forEach(starBlock => {
      const movieId = starBlock.getAttribute('data-movie');
      const stars = starBlock.querySelectorAll('i');

      stars.forEach(star => {
        star.addEventListener('click', () => {
          const selectedRating = parseInt(star.getAttribute('data-rating'));
          stars.forEach(s => {
            const current = parseInt(s.getAttribute('data-rating'));
            s.classList.toggle('active', current <= selectedRating);
          });

          if (!ratings[movieId]) {
            ratings[movieId] = { count: 0 };
          }
          ratings[movieId].count += 1;

          const countText = document.getElementById(`count-${movieId}`);
          countText.innerText = `Rated by ${ratings[movieId].count} user${ratings[movieId].count > 1 ? 's' : ''}`;
        });
      });
    });

    // Optional delete confirmation
    function confirmDelete() {
      if (confirm("Are you sure you want to delete this movie?")) {
        alert("Deleted (mock action).");
      }
    }
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
